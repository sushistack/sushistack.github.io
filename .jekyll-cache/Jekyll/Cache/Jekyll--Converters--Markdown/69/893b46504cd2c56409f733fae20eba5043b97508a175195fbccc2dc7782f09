I";
<p>웹사이트를 만들면서 Nginx 웹서버를 이용하게 되었습니다. 웹서버 설정을 하면서 발생했던 에러를 정리해보는 시간을 가져보도록하겠습니다.</p>

<h2 id="permission-denied-while-connecting-to-upstream">Permission denied while connecting to upstream</h2>

<p>우선 에러가 발생한다는 것은 Nginx를 구동한 후에 실제로 요청을 날려보면서 확인하게 되었습니다.</p>

<p>Nginx에서 보내주는 응답 코드는 <code class="language-plaintext highlighter-rouge">502 Bad Gateway</code> 였고, 원인을 파악하기 위해 로그를 확인해보았습니다.</p>

<h3 id="에러-로그-위치">에러 로그 위치</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/log/nginx/error.log
</code></pre></div></div>

<p>Nginx의 에러 로그는 기본적으로 위 위치에 남겨지게됩니다. 에러가 발생한다면 위 로그를 확인해서 어떤 에러인지 확인하실 수 있습니다.</p>

<h3 id="에러-원인">에러 원인</h3>

<p>에러로그 메시지에서 권한이 없다는 것을 보여주고 있습니다.</p>

<h3 id="에러-해결-방법">에러 해결 방법</h3>

<p>에러를 해결하는 방법은 굉장히 간단합니다. 보통 이런 에러가 발생했다면 서버 OS 자체의 보안을 의심해봐야합니다.</p>

<p>저같은 경우에는 <code class="language-plaintext highlighter-rouge">RedHat 8</code>을 이용하고 있었는데, <strong>SELinux</strong>라고 하는 OS 기본 보안프로세스 때문에 작동하지 않는 것을 확인했습니다.</p>

<p>다음과 같이 해결하실 수 있습니다.</p>

<ul>
  <li>httpd 네트워크 연결</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>setsebool httpd_can_network_connect on <span class="nt">-P</span>
<span class="c"># -P: 영구적으로 변경</span>
</code></pre></div></div>

<ul>
  <li>httpd 관련 설정 확인</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>getsebool <span class="nt">-a</span> | <span class="nb">grep </span>httpd
</code></pre></div></div>

<h2 id="맺음">맺음</h2>

<p>간단하게 <code class="language-plaintext highlighter-rouge">Permission denied while connecting to upstream</code> 에러가 발생하는 원인과 해결방법까지 소개해드렸습니다. 혹시 이상한 점이나 궁금하신 점이 있으면 댓글 부탁드리겠습니다.</p>

<p>감사합니다.</p>
:ET